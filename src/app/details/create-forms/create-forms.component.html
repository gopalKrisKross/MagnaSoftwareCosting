<div class="row">
  <div class="col-md-12">
    <nb-card class="inline-form-card" status="warning">
      <nb-card-header>Estimation</nb-card-header>
      <nb-card-body>
        <div class="row" [formGroup]="deptOptionForm">
          <div class="col-md-3">
            <nb-select
              placeholder="Department"
              size="small"
              class="formInput"
              formControlName="department"
            >
              <nb-option value="2">Select Deparment</nb-option>
              <nb-option
                *ngFor="let branch of departmentDetails"
                [value]="branch"
                >{{ branch }}</nb-option
              >
            </nb-select>
          </div>
          <div class="col-md-3">
            <nb-select
              placeholder="Software"
              size="small"
              class="formInput"
              name="software"
              formControlName="software"
            >
              <nb-option value="1">Select Software</nb-option>
              <nb-option value="CATIA">CATIA</nb-option>
              <nb-option value="UG">UG</nb-option>
            </nb-select>
          </div>
          <div class="col-md-2">
            <input
              nbInput
              [nbDatepicker]="fromDatePicker"
              fieldSize="small"
              class="formInput"
              name="fromDatePicker"
              formControlName="fromDatePicker"
            />
            <nb-datepicker #fromDatePicker format="MMM-YY"></nb-datepicker>
          </div>
          <div class="col-md-2">
            <input
              nbInput
              [nbDatepicker]="toDatePicker"
              fieldSize="small"
              class="formInput"
              name="toDatePicker"
              formControlName="toDatePicker"
            />
            <nb-datepicker #toDatePicker format="MMM-YY"></nb-datepicker>
          </div>
          <div class="text-center col-md-2">
            <button
              type="button"
              size="small"
              nbButton
              status="info"
              (click)="getData()"
            >
              Go
            </button>
          </div>
        </div>
        <div [formGroup]="departnentForm">
          <table
            class="table table-bordered label mt-3 text-center"
            id="departmentTable"
            *ngFor="let branch of departmentData"
          >
            <thead class="tHeading">
              <tr>
                <th>{{ branch }}</th>
                <th *ngFor="let header of headerList">{{ header }}</th>
              </tr>
            </thead>
            <tbody *ngFor="let project of getProject(branch)">
              <tr>
                <td rowspan="3" class=" ">
                  {{ project.value }}
                </td>
                <td>First</td>
                <td *ngFor="let val of data; let i = index" class="p-0">
                  <input
                    type="text"
                    class="formInput text-center"
                    status="basic"
                    fieldSize="small"
                    nbInput
                    formControlName="{{ branch }}First{{ i }}"
                  />
                </td>
              </tr>
              <tr>
                <td>Gen</td>
                <td *ngFor="let val of data; let i = index" class="p-0">
                  <input
                    type="text"
                    class="formInput text-center"
                    status="basic"
                    fieldSize="small"
                    nbInput
                    formControlName="{{ branch }}Gen{{ i }}"
                  />
                </td>
              </tr>
              <tr>
                <td>Sec</td>
                <td *ngFor="let val of data; let i = index" class="p-0">
                  <input
                    type="text"
                    class="formInput text-center"
                    status="basic"
                    fieldSize="small"
                    nbInput
                    formControlName="{{ branch }}Sec{{ i }}"
                  />
                </td>
              </tr>
              <tr>
                <td></td>
                <td>Total</td>
                <td *ngFor="let val of data; let i = index" class="fw-bold">
                  {{ getCalTotal(val) }}
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="offset-sm-11 col-sm-12" *ngIf="departmentData">
          <button
            type="button"
            size="small"
            nbButton
            status="info"
            (click)="saveData()"
          >
            save
          </button>
        </div>
      </nb-card-body>
    </nb-card>
  </div>
</div>
